<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LifeLink â€” Auth</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root{--bg:#f9fafb;--card:#fff;--text:#0f1720;--accent:#d90429;--muted:#6b7280}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif}
body{background:var(--bg);color:var(--text);transition:background .35s ease,color .35s ease;overflow-x:hidden}

    /* header */
  header{position:fixed;left:0;right:0;top:0;height:72px;display:flex;align-items:center;justify-content:center;z-index:100;backdrop-filter: blur(6px)}
    .nav-wrap{width:100%;max-width:1200px;padding:0 20px;display:flex;align-items:center;justify-content:space-between;}
    .brand{display:flex;gap:12px;align-items:center;cursor:pointer}
    .logo-dot{width:12px;height:12px;border-radius:50%;background:var(--danger);box-shadow:0 4px 14px rgba(217,4,41,0.25)}
    .brand h1{font-size:1.1rem;color:var(--text);letter-spacing:0.2px}
    .nav-actions{display:flex;align-items:center;gap:14px}

    .cta-btn{background:var(--danger);color:#fff;padding:8px 14px;border-radius:999px;border:0;font-weight:600;box-shadow:0 6px 20px rgba(217,4,41,0.18);cursor:pointer;transition:transform .18s ease,box-shadow .18s ease}
    .cta-btn:active{transform:translateY(1px)}

    /* hamburger */
  .hambtn{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;border:0;background:transparent;cursor:pointer;position:relative;z-index:110}
    .ham-inner{width:26px;height:20px;position:relative}
    .ham-inner span{position:absolute;left:0;right:0;height:3px;background:var(--text);border-radius:4px;transition:all .35s cubic-bezier(.2,.9,.26,1)}
    .ham-inner span:nth-child(1){top:0}
    .ham-inner span:nth-child(2){top:8px}
    .ham-inner span:nth-child(3){top:16px}
    .hambtn.open .ham-inner span:nth-child(1){transform:translateY(8px) rotate(45deg);}
    .hambtn.open .ham-inner span:nth-child(2){opacity:0}
    .hambtn.open .ham-inner span:nth-child(3){transform:translateY(-8px) rotate(-45deg)}

    /* full-screen nav overlay */
    .overlay{position:fixed;inset:0;background:linear-gradient(135deg, rgba(15,23,32,0.94), rgba(10,14,18,0.98));transform:translateX(100%);transition:transform .45s cubic-bezier(.2,.9,.26,1);z-index:80;display:flex;align-items:center;justify-content:center}
    .overlay.open{transform:translateX(0)}
    .overlay-inner{width:100%;max-width:640px;padding:48px;background:transparent;display:flex;flex-direction:column;gap:26px}
    .overlay nav{display:flex;flex-direction:column;gap:18px;margin-top:10px}
    .overlay a{color:#fff;text-decoration:none;font-size:24px;font-weight:600;padding:12px 18px;border-radius:12px;transition:background .18s}
    .overlay a:hover{background:rgba(255,255,255,0.04)}
    .overlay .small-links{margin-top:18px;display:flex;gap:12px}

    

    @media (max-width:640px){
      header{height:64px}
      .nav-wrap{padding:0 14px;}
      .brand h1{font-size:1rem}

      .overlay-inner{padding:28px}
      .overlay a{font-size:20px}
    }

.auth-container{min-height:calc(100vh - 72px);display:flex;align-items:center;justify-content:center;padding:72px 16px 32px}
@media (max-width:640px){
  .auth-container{min-height:calc(100vh - 64px);padding-top:64px}
}

.card{background:var(--card);padding:32px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.05);width:350px;transition:0.3s ease;}
.card:hover{transform:translateY(-4px);box-shadow:0 12px 28px rgba(0,0,0,0.08);}
h2{text-align:center;margin-bottom:20px;transition:0.2s;}
form{display:flex;flex-direction:column;gap:12px}
input,select{padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.1);width:100%}
button{padding:12px;border:none;border-radius:8px;background:var(--accent);color:#fff;cursor:pointer;font-weight:600;transition:0.2s}
button:hover{opacity:0.9}
.toggle-link{font-size:0.9rem;color:var(--accent);text-align:center;cursor:pointer;margin-top:8px}
</style>
</head>
<body>

   <header>
    <div class="nav-wrap">
      <div class="brand" onclick="scrollToTop()">
        <div class="logo-dot" aria-hidden></div>
        <h1 style="color: rgb(129, 192, 129);font-size:1.3rem;">LifeLink</h1>
      </div>

  <div class="nav-actions">
        <button id="themeBtn" class="cta-btn" aria-pressed="false" title="Toggle theme">ðŸŒ™</button>
        <button class="hambtn" id="hambtn" aria-label="Open menu">
          <div class="ham-inner">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </button>
      </div>
    </div>
  </header>

  <div id="overlay" class="overlay" aria-hidden="true">
    <div class="overlay-inner">
      
      <nav>
        <a href="index.html" class="nav-link">Home</a>
        <a href="about.html" class="nav-link">About</a>
        <a href="contact.html" class="nav-link">Contact</a>
        <a href="auth.html" class="nav-link">Login / Register</a>
      </nav>
      <div class="small-links">
        <button class="cta-btn" onclick="location.href='auth.html'">Get Started</button>
        <button class="cta-btn" style="background:transparent;border:1px solid rgba(255,255,255,0.12);" onclick="location.href='donor.html'">Donate Now</button>
      </div>
    </div>
  </div>

<main class="auth-container">
  <div class="card">
    <h2 id="formTitle">Register</h2>
    <form id="authForm">
        <input type="text" id="name" placeholder="Full Name" required>
        <input type="email" id="email" placeholder="Email" required>
        <input type="password" id="password" placeholder="Password" required>
        <select id="type" required>
            <option value="donor">Donor</option>
            <option value="hospital">Hospital</option>
        </select>
        <button type="submit" id="submitBtn">Register</button>
    </form>
    <div class="toggle-link" id="toggleAuth">Already have an account? Login</div>
  </div>
</main>

<script>
// Toggle Register/Login
let isRegister = true;
const formTitle = document.getElementById('formTitle');
const submitBtn = document.getElementById('submitBtn');
const toggleLink = document.getElementById('toggleAuth');
const typeSelect = document.getElementById('type');
const nameField = document.getElementById('name');

toggleLink.addEventListener('click', () => {
    isRegister = !isRegister;
    if(isRegister){
        formTitle.textContent = 'Register';
        submitBtn.textContent = 'Register';
        typeSelect.style.display = 'block';
        nameField.style.display = 'block';
        toggleLink.textContent = 'Already have an account? Login';
    } else {
        formTitle.textContent = 'Login';
        submitBtn.textContent = 'Login';
        typeSelect.style.display = 'none';
        nameField.style.display = 'none';
        toggleLink.textContent = 'Don\'t have an account? Register';
    }
});

// Handle form submission
document.getElementById('authForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const name = nameField.value.trim();
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value.trim();
    const type = typeSelect.value;

    try {
        const url = isRegister 
            ? 'http://localhost:5000/api/auth/register' 
            : 'http://localhost:5000/api/auth/login';
        
        const bodyData = isRegister 
            ? {name, email, password, type} 
            : {email, password};

        const res = await fetch(url, {
            method: 'POST',
            headers: {'Content-Type':'application/json'},
            body: JSON.stringify(bodyData)
        });

        const data = await res.json();

        if(res.ok){
            // Determine type safely
            const userType = isRegister ? type.toLowerCase() : (data.hospital ? 'hospital' : 'donor');
            const userName = isRegister ? name : (data.hospital?.name || data.donor?.name);

            const userData = {name: userName, email, type: userType};

            if(userType === 'donor'){
                localStorage.setItem('donorData', JSON.stringify(userData));
                window.location.href = 'donor.html';
            } else if(userType === 'hospital'){
                localStorage.setItem('hospitalData', JSON.stringify(userData));
                // Initialize blood packs if not present
                if(!localStorage.getItem('bloodPacks')){
                    localStorage.setItem('bloodPacks', JSON.stringify([]));
                }
                window.location.href = 'hospital.html';
            }
        } else {
            alert(data.message || 'Error: Check details.');
        }
    } catch(err){
        console.error(err);
        alert('Server error. Try again later.');
    }
});
</script>
<script src="js/main.js"></script>
</body>
</html>
